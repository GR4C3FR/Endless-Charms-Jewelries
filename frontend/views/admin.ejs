<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - Endless Charms</title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <!-- Navigation Header -->
    <header class="main-header">
        <div class="container">
            <nav class="navbar">
                <a href="/" class="logo">
                    <img src="/images/navigation/logo.png" alt="Endless Charms Logo" class="logo-img">
                </a>
                <div class="nav-links">
                    <a href="/" class="nav-link">HOME</a>
                    <a href="/blogs" class="nav-link">BLOGS</a>
                    <div class="nav-item">
                        <span class="nav-link">SHOP</span>
                        <div class="dropdown-menu">
                            <a href="/engagement-rings">Engagement Rings</a>
                            <a href="/wedding-bands">Wedding Bands</a>
                            <a href="/accessories">Other Accessories</a>
                        </div>
                    </div>
                    <a href="/contact" class="nav-link">CONTACT</a>
                    <a href="/about" class="nav-link">ABOUT</a>
                </div>
                <div class="nav-icons">
                    <button class="icon-btn" onclick="window.location.href='/profile'">
                        <img src="/images/navigation/profile-icon.png" alt="Profile" class="profile-icon">
                    </button>
                    <button class="icon-btn" onclick="window.location.href='/bag'">
                        <img src="/images/navigation/bag.png" alt="Shopping Bag" class="bag-icon">
                    </button>
                </div>
            </nav>
        </div>
    </header>

    <div class="admin-container">
        <div class="admin-header">
            <h1>Admin Panel</h1>
            <p>Manage your blog posts and content here.</p>
        </div>

        <div class="admin-tabs">
            <button class="admin-tab active" data-tab="create">Create Blog</button>
            <button class="admin-tab" data-tab="manage">Manage Blogs</button>
        </div>

        <!-- Create Blog Tab -->
        <div id="create-tab" class="tab-content active">
            <h2 id="form-title">Create New Blog Post</h2>
            <div id="create-alert" class="alert"></div>
            
            <form id="create-blog-form" enctype="multipart/form-data">
                <input type="hidden" id="blog-id" name="blogId">
                <div class="form-group">
                    <label for="title">Blog Title *</label>
                    <input type="text" id="title" name="title" required placeholder="Enter an engaging title for your blog post">
                </div>

                <div class="form-group">
                    <label for="image">Blog Image <span id="image-required">*</span></label>
                    <input type="file" id="image" name="image" accept="image/*" required>
                    <div id="image-preview" class="image-preview"></div>
                    <small id="image-note" style="display: none; color: #6b7280;">Leave empty to keep existing image</small>
                </div>

                <div class="form-group">
                    <label for="excerpt">Excerpt *</label>
                    <textarea id="excerpt" name="excerpt" required placeholder="Write a brief summary that will appear in the blog list (150-200 characters recommended)"></textarea>
                </div>                <div class="form-group">
                    <label for="content">Content *</label>
                    <div class="formatting-guide">
                        <details>
                            <summary>Formatting Guide</summary>
                            <div class="guide-content">
                                <h4>How to Format Your Blog Content:</h4>
                                
                                <div class="guide-section">
                                    <strong>Main Headings (H2):</strong>
                                    <code>&lt;h2&gt;Your Main Section Title&lt;/h2&gt;</code>
                                    <p>Use for major sections - these appear in the Table of Contents</p>
                                </div>
                                
                                <div class="guide-section">
                                    <strong>Subheadings (H3):</strong>
                                    <code>&lt;h3&gt;Your Subsection Title&lt;/h3&gt;</code>
                                    <p>Use for subsections under main headings</p>
                                </div>
                                
                                <div class="guide-section">
                                    <strong>Paragraphs:</strong>
                                    <code>&lt;p&gt;Your paragraph text here.&lt;/p&gt;</code>
                                    <p>Wrap each paragraph in &lt;p&gt; tags</p>
                                </div>
                                
                                <div class="guide-section">
                                    <strong>Bold Text:</strong>
                                    <code>&lt;strong&gt;Important text&lt;/strong&gt;</code>
                                    <p>Use for emphasis and key points</p>
                                </div>
                                
                                <div class="guide-section">
                                    <strong>Bullet Lists:</strong>
                                    <code>&lt;ul&gt;<br>&nbsp;&nbsp;&lt;li&gt;First item&lt;/li&gt;<br>&nbsp;&nbsp;&lt;li&gt;Second item&lt;/li&gt;<br>&lt;/ul&gt;</code>
                                    <p>Use for unordered lists</p>
                                </div>
                                
                                <div class="guide-section">
                                    <strong>Numbered Lists:</strong>
                                    <code>&lt;ol&gt;<br>&nbsp;&nbsp;&lt;li&gt;First step&lt;/li&gt;<br>&nbsp;&nbsp;&lt;li&gt;Second step&lt;/li&gt;<br>&lt;/ol&gt;</code>
                                    <p>Use for ordered/sequential lists</p>
                                </div>
                                
                                <div class="guide-example">
                                    <strong>ðŸ“‹ Complete Example:</strong>
                                    <pre>&lt;p&gt;Introduction paragraph goes here.&lt;/p&gt;

&lt;h2&gt;Main Section Title&lt;/h2&gt;
&lt;p&gt;Paragraph explaining the section.&lt;/p&gt;

&lt;h3&gt;Subsection Title&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;Point One:&lt;/strong&gt; Description here&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Point Two:&lt;/strong&gt; Description here&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;Step-by-Step Instructions&lt;/h3&gt;
&lt;ol&gt;
  &lt;li&gt;First step description&lt;/li&gt;
  &lt;li&gt;Second step description&lt;/li&gt;
  &lt;li&gt;Third step description&lt;/li&gt;
&lt;/ol&gt;</pre>
                                </div>
                            </div>
                        </details>
                    </div>                    <div class="formatting-toolbar">
                        <button type="button" class="format-btn" onclick="insertFormatting('h2')" title="Main Heading">H2</button>
                        <button type="button" class="format-btn" onclick="insertFormatting('h3')" title="Subheading">H3</button>
                        <button type="button" class="format-btn" onclick="insertFormatting('p')" title="Paragraph">P</button>
                        <button type="button" class="format-btn" onclick="insertFormatting('strong')" title="Bold"><strong>B</strong></button>
                        <button type="button" class="format-btn" onclick="insertFormatting('ul')" title="Bullet List">â€¢ List</button>
                        <button type="button" class="format-btn" onclick="insertFormatting('ol')" title="Numbered List">1. List</button>
                        <button type="button" class="format-btn template-btn" onclick="insertTemplate()" title="Insert Blog Template">Template</button>
                    </div>                    <textarea id="content" name="content" class="content-textarea" required placeholder="Write your blog content with HTML formatting. Use the toolbar above for quick formatting or click the guide for examples."></textarea>
                    <div class="content-stats">
                        <span id="char-count">0 characters</span>
                        <span id="word-count">0 words</span>
                        <span id="html-validation" class="validation-ok">âœ“ Valid HTML</span>
                    </div>
                    <div class="content-preview-toggle">
                        <button type="button" class="btn btn-secondary preview-btn" onclick="togglePreview()">Preview Content</button>
                    </div>
                    <div id="content-preview" class="content-preview" style="display: none;">
                        <h3>Content Preview:</h3>
                        <div id="preview-render" class="blog-detail-content"></div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="author">Author</label>
                    <input type="text" id="author" name="author" value="Endless Charms" placeholder="Author name">
                </div>

                <div class="form-group">
                    <label for="tags">Tags (comma separated)</label>
                    <input type="text" id="tags" name="tags" placeholder="e.g., engagement rings, wedding planning, jewelry care">
                </div>

                <div class="form-group">
                    <div class="checkbox-group">
                        <input type="checkbox" id="published" name="published" checked>
                        <label for="published">Publish immediately</label>
                    </div>
                </div>

                <div class="form-group" id="schedule-group" style="display: none;">
                    <label for="scheduledPublishDate">Schedule Publish Date & Time</label>
                    <input type="datetime-local" id="scheduledPublishDate" name="scheduledPublishDate" style="padding: 12px;">
                    <small style="color: #6b7280; display: block; margin-top: 5px;">Leave empty to publish immediately. Set a future date to schedule publication.</small>
                </div>

                <button type="submit" class="btn btn-primary" id="submit-btn">Create Blog Post</button>
                <button type="button" class="btn btn-secondary" id="cancel-edit-btn" style="display: none; margin-left: 10px;" onclick="cancelEdit()">Cancel</button>
            </form>
        </div>

        <!-- Manage Blogs Tab -->
        <div id="manage-tab" class="tab-content">
            <h2>Manage Blog Posts</h2>
            <div id="manage-alert" class="alert"></div>
            
            <div id="blogs-list">
                <div class="loading">Loading blogs...</div>
            </div>
        </div>
    </div>    <script>
        // Insert formatting helper function
        function insertFormatting(type) {
            const textarea = document.getElementById('content');
            const start = textarea.selectionStart;
            const end = textarea.selectionEnd;
            const selectedText = textarea.value.substring(start, end);
            const hasSelection = selectedText.length > 0;
            
            let beforeText = '';
            let afterText = '';
            let newCursorPos = start;
            
            switch(type) {
                case 'h2':
                    beforeText = '<h2>';
                    afterText = '</h2>\n\n';
                    break;
                case 'h3':
                    beforeText = '<h3>';
                    afterText = '</h3>\n\n';
                    break;
                case 'p':
                    beforeText = '<p>';
                    afterText = '</p>\n\n';
                    break;
                case 'strong':
                    beforeText = '<strong>';
                    afterText = '</strong>';
                    break;
                case 'ul':
                    beforeText = '<ul>\n  <li>';
                    afterText = '</li>\n  <li>Second item</li>\n  <li>Third item</li>\n</ul>\n\n';
                    break;
                case 'ol':
                    beforeText = '<ol>\n  <li>';
                    afterText = '</li>\n  <li>Second step</li>\n  <li>Third step</li>\n</ol>\n\n';
                    break;
            }
            
            const newText = beforeText + (hasSelection ? selectedText : 'Your text here') + afterText;
            textarea.value = textarea.value.substring(0, start) + newText + textarea.value.substring(end);
            
            // Set cursor position
            if (hasSelection) {
                newCursorPos = start + newText.length;
            } else {
                newCursorPos = start + beforeText.length;
            }
            
            textarea.focus();
            textarea.setSelectionRange(newCursorPos, newCursorPos + (hasSelection ? 0 : 'Your text here'.length));
        }
          // Toggle preview function
        function togglePreview() {
            const preview = document.getElementById('content-preview');
            const previewRender = document.getElementById('preview-render');
            const content = document.getElementById('content').value;
            const button = event.target;
            
            if (preview.style.display === 'none') {
                previewRender.innerHTML = content || '<p style="color: #6b7280; font-style: italic;">No content to preview yet. Start writing your blog content above.</p>';
                preview.style.display = 'block';
                button.textContent = 'Hide Preview';
            } else {
                preview.style.display = 'none';
                button.textContent = 'Preview Content';
            }
        }
          // Insert blog template
        function insertTemplate() {
            const textarea = document.getElementById('content');
            if (textarea.value.trim() !== '' && !confirm('This will replace your current content. Continue?')) {
                return;
            }
            
            const template = `<p>Write an engaging introduction paragraph that hooks the reader and introduces the main topic of your blog post. Make it clear what value the reader will get from reading this article.</p>

<h2>First Main Section Title</h2>
<p>Provide context and background information for this section. Explain the importance of this topic to your readers.</p>

<h3>Key Points or Benefits</h3>
<ul>
  <li><strong>First Point:</strong> Detailed explanation of this point</li>
  <li><strong>Second Point:</strong> Detailed explanation of this point</li>
  <li><strong>Third Point:</strong> Detailed explanation of this point</li>
  <li><strong>Fourth Point:</strong> Detailed explanation of this point</li>
</ul>

<h2>Second Main Section Title</h2>
<p>Continue building on your topic with additional insights and information. Make sure each section flows naturally to the next.</p>

<h3>Step-by-Step Guide or Process</h3>
<ol>
  <li>First step with detailed explanation</li>
  <li>Second step with detailed explanation</li>
  <li>Third step with detailed explanation</li>
  <li>Fourth step with detailed explanation</li>
</ol>

<h3>Additional Subsection</h3>
<p>Provide more detailed information, tips, or insights related to this topic.</p>

<h2>Third Main Section Title</h2>
<p>Add more sections as needed for your topic. Each main section should cover a distinct aspect of your subject.</p>

<h3>Important Considerations</h3>
<ul>
  <li>First consideration or tip</li>
  <li>Second consideration or tip</li>
  <li>Third consideration or tip</li>
</ul>

<h2>Conclusion or Final Thoughts</h2>
<p>Summarize the key takeaways from your blog post. Reinforce the main message and provide a call-to-action or next steps for your readers.</p>

<p><strong>Ready to get started? Contact Endless Charms today for personalized assistance and expert guidance!</strong></p>`;
            
            textarea.value = template;
            textarea.focus();
            updateContentStats();
            showAlert('create-alert', 'Blog template inserted! Customize it with your content.', 'success');
        }
        
        // Update content stats and validation
        function updateContentStats() {
            const content = document.getElementById('content').value;
            const charCount = document.getElementById('char-count');
            const wordCount = document.getElementById('word-count');
            const validation = document.getElementById('html-validation');
            
            // Character count
            charCount.textContent = `${content.length} characters`;
            
            // Word count (strip HTML and count)
            const textOnly = content.replace(/<[^>]*>/g, ' ').trim();
            const words = textOnly.split(/\s+/).filter(word => word.length > 0);
            wordCount.textContent = `${words.length} words`;
            
            // Basic HTML validation
            const htmlTags = ['h2', 'h3', 'p', 'ul', 'ol', 'li', 'strong', 'br', 'a'];
            let isValid = true;
            let errorMsg = '';
            
            // Check for unclosed tags
            const tagStack = [];
            const tagRegex = /<\/?(\w+)[^>]*>/g;
            let match;
            
            while ((match = tagRegex.exec(content)) !== null) {
                const fullTag = match[0];
                const tagName = match[1].toLowerCase();
                
                // Skip self-closing and BR tags
                if (fullTag.endsWith('/>') || tagName === 'br') continue;
                
                if (fullTag.startsWith('</')) {
                    // Closing tag
                    if (tagStack.length === 0 || tagStack[tagStack.length - 1] !== tagName) {
                        isValid = false;
                        errorMsg = `Mismatched closing tag: </${tagName}>`;
                        break;
                    }
                    tagStack.pop();
                } else {
                    // Opening tag
                    tagStack.push(tagName);
                }
            }
            
            // Check if any tags weren't closed
            if (isValid && tagStack.length > 0) {
                isValid = false;
                errorMsg = `Unclosed tag: <${tagStack[tagStack.length - 1]}>`;
            }
            
            // Update validation display
            if (content.trim() === '') {
                validation.textContent = 'âœ“ Valid HTML';
                validation.className = 'validation-ok';
            } else if (isValid) {
                validation.textContent = 'âœ“ Valid HTML';
                validation.className = 'validation-ok';
            } else {
                validation.textContent = `âš  ${errorMsg}`;
                validation.className = 'validation-error';
            }
        }
        
        // Add event listener to content textarea
        document.getElementById('content').addEventListener('input', updateContentStats);
        
        // Initial stats update
        updateContentStats();

        // Toggle schedule field based on publish checkbox
        const publishedCheckbox = document.getElementById('published');
        const scheduleGroup = document.getElementById('schedule-group');
        const scheduledDateInput = document.getElementById('scheduledPublishDate');

        publishedCheckbox.addEventListener('change', function() {
            if (!this.checked) {
                scheduleGroup.style.display = 'block';
            } else {
                scheduleGroup.style.display = 'none';
                scheduledDateInput.value = '';
            }
        });

        // Tab switching
        document.querySelectorAll('.admin-tab').forEach(tab => {
            tab.addEventListener('click', () => {
                const tabName = tab.dataset.tab;
                
                // Update active tab
                document.querySelectorAll('.admin-tab').forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                
                // Update active content
                document.querySelectorAll('.tab-content').forEach(content => {
                    content.classList.remove('active');
                });
                document.getElementById(`${tabName}-tab`).classList.add('active');
                
                // Load blogs when switching to manage tab
                if (tabName === 'manage') {
                    loadBlogs();
                }
            });
        });

        // Image preview
        document.getElementById('image').addEventListener('change', function(e) {
            const file = e.target.files[0];
            const preview = document.getElementById('image-preview');
            
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    preview.innerHTML = `<img src="${e.target.result}" alt="Preview">`;
                };
                reader.readAsDataURL(file);
            } else {
                preview.innerHTML = '';
            }
        });

        // Show alert function
        function showAlert(elementId, message, type) {
            const alert = document.getElementById(elementId);
            alert.textContent = message;
            alert.className = `alert alert-${type} show`;
            
            setTimeout(() => {
                alert.classList.remove('show');
            }, 5000);
        }

        // Create/Edit blog form submission
        document.getElementById('create-blog-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const submitBtn = e.target.querySelector('button[type="submit"]');
            const blogId = document.getElementById('blog-id').value;
            
            // Explicitly set the published value based on checkbox state
            const publishedCheckbox = document.getElementById('published');
            formData.set('published', publishedCheckbox.checked ? 'true' : 'false');
            
            // Determine if we're creating or editing
            const isEditing = blogId !== '';
            const url = isEditing ? `/api/admin/blogs/${blogId}` : '/api/admin/blogs';
            const method = isEditing ? 'PUT' : 'POST';
            
            // Disable button during submission
            submitBtn.disabled = true;
            submitBtn.textContent = isEditing ? 'Updating...' : 'Creating...';
            
            try {
                const response = await fetch(url, {
                    method: method,
                    body: formData
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    showAlert('create-alert', isEditing ? 'Blog post updated successfully!' : 'Blog post created successfully!', 'success');
                    cancelEdit(); // Reset form
                    loadBlogs(); // Refresh blog list
                } else {
                    showAlert('create-alert', data.message || `Failed to ${isEditing ? 'update' : 'create'} blog post`, 'error');
                }
            } catch (error) {
                showAlert('create-alert', 'An error occurred. Please try again.', 'error');
                console.error('Error:', error);
            } finally {
                submitBtn.disabled = false;
                submitBtn.textContent = isEditing ? 'Update Blog Post' : 'Create Blog Post';
            }
        });

        // Load blogs function
        async function loadBlogs() {
            const blogsList = document.getElementById('blogs-list');
            blogsList.innerHTML = '<div class="loading">Loading blogs...</div>';
            
            try {
                const response = await fetch('/api/admin/blogs');
                const blogs = await response.json();
                
                if (blogs.length === 0) {
                    blogsList.innerHTML = `
                        <div class="empty-state">
                            <h3>No blogs yet</h3>
                            <p>Create your first blog post to get started!</p>
                        </div>
                    `;
                    return;
                }
                
                blogsList.innerHTML = `
                    <div class="blog-list">
                        ${blogs.map(blog => `
                            <div class="blog-item" data-id="${blog._id}">
                                <img src="${blog.image}" alt="${blog.title}" class="blog-item-image">
                                <div class="blog-item-content">
                                    <h3 class="blog-item-title">${blog.title}</h3>
                                    <div class="blog-item-meta">
                                        <span class="status-badge ${blog.published ? 'status-published' : (blog.scheduledPublishDate ? 'status-scheduled' : 'status-draft')}">
                                            ${blog.published ? 'Published' : (blog.scheduledPublishDate ? 'Scheduled' : 'Draft')}
                                        </span>
                                        <span style="margin-left: 10px;">
                                            ${blog.scheduledPublishDate ? 'Scheduled: ' + new Date(blog.scheduledPublishDate).toLocaleString() : (blog.publishedAt ? new Date(blog.publishedAt).toLocaleDateString() : 'Not published')}
                                        </span>
                                    </div>
                                    <p>${blog.excerpt.substring(0, 150)}...</p>
                                    <div class="blog-item-actions">
                                        <button class="btn btn-secondary" onclick="editBlog('${blog._id}')">Edit</button>
                                        <button class="btn btn-secondary" onclick="viewBlog('${blog.slug}')">View</button>
                                        <button class="btn btn-danger" onclick="deleteBlog('${blog._id}')">Delete</button>
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                `;
            } catch (error) {
                blogsList.innerHTML = `
                    <div class="empty-state">
                        <h3>Error loading blogs</h3>
                        <p>Please try again later.</p>
                    </div>
                `;
                console.error('Error:', error);
            }
        }

        // Edit blog function
        async function editBlog(id) {
            try {
                const response = await fetch(`/api/blogs/${id}`);
                const blog = await response.json();
                
                if (response.ok) {
                    // Switch to create tab
                    document.querySelector('[data-tab="create"]').click();
                    
                    // Update form title and button
                    document.getElementById('form-title').textContent = 'Edit Blog Post';
                    document.getElementById('submit-btn').textContent = 'Update Blog Post';
                    document.getElementById('cancel-edit-btn').style.display = 'inline-block';
                    
                    // Populate form fields
                    document.getElementById('blog-id').value = blog._id;
                    document.getElementById('title').value = blog.title;
                    document.getElementById('excerpt').value = blog.excerpt;
                    document.getElementById('content').value = blog.content;
                    document.getElementById('author').value = blog.author;
                    document.getElementById('tags').value = blog.tags.join(', ');
                    document.getElementById('published').checked = blog.published;
                    
                    // Handle scheduled date
                    if (blog.scheduledPublishDate) {
                        const scheduleDate = new Date(blog.scheduledPublishDate);
                        const localDateTime = new Date(scheduleDate.getTime() - scheduleDate.getTimezoneOffset() * 60000)
                            .toISOString()
                            .slice(0, 16);
                        document.getElementById('scheduledPublishDate').value = localDateTime;
                        document.getElementById('schedule-group').style.display = 'block';
                        document.getElementById('published').checked = false;
                    }
                    
                    // Show current image
                    document.getElementById('image-preview').innerHTML = `<img src="${blog.image}" alt="Current image">`;
                      // Make image optional for editing
                    document.getElementById('image').required = false;
                    document.getElementById('image-required').style.display = 'none';
                    document.getElementById('image-note').style.display = 'block';
                    
                    // Update content stats
                    updateContentStats();
                    
                    // Scroll to top
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                } else {
                    alert('Failed to load blog details');
                }
            } catch (error) {
                console.error('Error:', error);
                alert('An error occurred while loading the blog');
            }
        }        // Cancel edit function
        function cancelEdit() {
            // Reset form
            document.getElementById('create-blog-form').reset();
            document.getElementById('blog-id').value = '';
            document.getElementById('image-preview').innerHTML = '';
            document.getElementById('scheduledPublishDate').value = '';
            document.getElementById('schedule-group').style.display = 'none';
            
            // Reset form title and button
            document.getElementById('form-title').textContent = 'Create New Blog Post';
            document.getElementById('submit-btn').textContent = 'Create Blog Post';
            document.getElementById('cancel-edit-btn').style.display = 'none';
            
            // Make image required again
            document.getElementById('image').required = true;
            document.getElementById('image-required').style.display = 'inline';
            document.getElementById('image-note').style.display = 'none';
            
            // Reset published checkbox to checked
            document.getElementById('published').checked = true;
            
            // Reset content stats
            updateContentStats();
            
            // Hide preview if visible
            document.getElementById('content-preview').style.display = 'none';
            const previewBtn = document.querySelector('.content-preview-toggle .btn');
            if (previewBtn) previewBtn.textContent = 'Preview Content'; 
        }

        // View blog function
        function viewBlog(slug) {
            window.open(`/blogs/${slug}`, '_blank');
        }

        // Delete blog function
        async function deleteBlog(id) {
            if (!confirm('Are you sure you want to delete this blog post? This action cannot be undone.')) {
                return;
            }
            
            try {
                const response = await fetch(`/api/admin/blogs/${id}`, {
                    method: 'DELETE'
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    showAlert('manage-alert', 'Blog post deleted successfully!', 'success');
                    loadBlogs();
                } else {
                    showAlert('manage-alert', data.message || 'Failed to delete blog post', 'error');
                }
            } catch (error) {
                showAlert('manage-alert', 'An error occurred. Please try again.', 'error');
                console.error('Error:', error);
            }
        }

        // Load blogs on page load if manage tab is active
        if (document.getElementById('manage-tab').classList.contains('active')) {
            loadBlogs();
        }
    </script>
</body>
</html>
